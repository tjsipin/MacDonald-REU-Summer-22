---
title: "exploration"
author: "Lyndsey Umsted"
date: '2022-07-12'
output:
  pdf_document: default
  html_document: default
---

Tidying dataset and removing outliers for each variable
```{r}
getwd()
aad <- read.csv("data/aad.csv")
aad <-subset(aad, aad$Cutaneous.Leishmaniasis > 0)
aad <-subset(aad, aad$Year < 2019)
```

```{r}
aad <-subset(aad, aad$Population < 4000000)
aad <-subset(aad, aad$Precip < 6000)
aad <-subset(aad, aad$LST_Day < 37)
aad <-subset(aad, aad$LST_Day > 17)
aad <-subset(aad, aad$AvgRad < 50)
aad <-subset(aad, aad$NDVI > 0.2)
aad <-subset(aad, aad$EVI > 0.1)
aad <-subset(aad, aad$pland_forest > 0)
aad <-subset(aad, aad$te_forest > 0)
aad <-subset(aad, aad$enn_mn_forest > 0)
aad <-subset(aad, aad$enn_mn_forest < 3000)
```

Removing NAs:
```{r}
aad <- subset(aad, !is.na(aad$Cutaneous.Leishmaniasis))
aad <- subset(aad, !is.na(aad$Precip))
aad <- subset(aad, !is.na(aad$LST_Day))
aad <- subset(aad, !is.na(aad$SWOccurrence))
aad <- subset(aad, !is.na(aad$AvgRad))
aad <- subset(aad, !is.na(aad$Population))
aad <- subset(aad, !is.na(aad$EVI))
aad <- subset(aad, !is.na(aad$pland_forest))
aad <- subset(aad, !is.na(aad$te_forest))
aad <- subset(aad, !is.na(aad$enn_mn_forest))
```



```{r}
plot(aad$Year, aad$Cutaneous.Leishmaniasis)
boxplot(aad$te_forest[aad$Year == 2001])
```


```{r}
library(dplyr)
mean_Cutaneous <- aad %>%
  group_by(Year) %>%
  summarise_at(vars(EVI), list(name = mean))
mean_Cutaneous
plot(mean_Cutaneous, main = "Enhanced Vegetation Index between 2001 and 2019", xlab = "Year", ylab = "EVI")

# mean_te_forest <- aad %>%
#   group_by(Year) %>%
#   summarise_at(vars(NDVI), list(name = mean))
# mean_te_forest
# plot(mean_te_forest)

fit <- lm(aad$EVI ~ aad$Year, data = aad)
summary(fit)
abline(fit, col = "red")
```



```{r}
set.seed(2)
sample <- sample_n(aad, 500)

fit <- lm(sample$Cutaneous.Leishmaniasis ~ sample$EVI, data = sample)
summary(fit)

confint(fit)
plot(sample$EVI, sample$Cutaneous.Leishmaniasis, main = "Enhanced Vegetation Index vs Cutaneous Leishmaniasis Cases", xlab = "EVI", ylab = "Cases per Thousand")
abline(fit, col = "red")
# 
# library(MASS)
# boxcox(fit, lambda =seq(-0.1,0.1, 1), plotit = TRUE)
```


Diagnostic PlotS:
```{r}
# par(mfrow = c(2,2), mgp = c(2,1,0), mar = c(3,3,3,1) + 0.1)
# plot(fitted(fit), residuals(fit), xlab = "fitted", ylab = "residuals")
# abline(h=0)
# title("Residuals vs Fitted")
# qqnorm(residuals(fit), ylab = "residuals", main = "QQ plot")
# qqline(residuals(fit))
# plot(sample$human_footprint, residuals(fit), xlab = "time", ylab = "resdisuals")
# abline(h=0)
# title("Residuals vs human_footprint")
```







