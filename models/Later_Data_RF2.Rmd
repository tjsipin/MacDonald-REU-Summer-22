---
title: "Later Data Random Forest Implementation 2"
author: "Lyndsey Umsted"
date: '2022-06-30'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("randomForest")
library(randomForest)
```
Importing File into R:
```{r}
aad <- read.csv("Annual_Amazon_Data.csv")
#view(aad)

cutaneous <- aad$Cutaneous.Leishmaniasis
mucosal <- aad$Mucosal.Leishmaniasis
visceral <- aad$Visceral.Leishmaniasis
new_data <- subset(aad, !is.na(cutaneous))
#View(new_data)
#names(new_data)
```


Extracting Later Data and Tidying it:
```{r}
## splitting the data into a before 2014 set and an after 2014 set
library(dplyr)
early_data <- new_data %>%
  filter(Year < 2014)%>%
  select(-c(29:69))
later_data <- new_data %>%
  filter(Year > 2013) %>%
  select(-c(29:69))

#names(early_data)

## removing unnecessary variables

early_data <- early_data %>%
  select(-c("AvgRad"))
later_data <- later_data %>%
  select(-c("StableLights"))

# later_data$OptTemp_Obs <- as.numeric(later_data$OptTemp_Obs)
# later_data$Year <- as.numeric(later_data$Year)
# later_data$Population <- as.numeric(later_data$Population)

later_data_small <- later_data %>%
  select(c("Year", "Population", "Cutaneous.Leishmaniasis", "LST_Day", "LST_Night", "OptTemp_Obs", "NDVI", "EVI", "Precip", "AvgRad", "SWOccurrence")) %>%
  na.omit(later_data_small) 
later_data_t <- later_data_small %>%
  mutate(Cutaneous.Leishmaniasis = (Cutaneous.Leishmaniasis))
```

```{r}
library(dplyr)
summary(later_data_small$Cutaneous.Leishmaniasis[later_data_small$Cutaneous.Leishmaniasis > 0])
cat_df <- subset(later_data_small, later_data_small$Cutaneous.Leishmaniasis > 0)
cat_df$Cutaneous.Leishmaniasis <- cut(later_data_small$Cutaneous.Leishmaniasis[later_data_small$Cutaneous.Leishmaniasis > 0], breaks = c(0, 0.090114445 , 0.876904527, 10^3), labels = c("low", "moderate", "high")) # 25%, 75%, 100%

# cat_df$label <- NA
# cat_df$label[cat_df$Cutaneous.Leishmaniasis == "low"] <- 0
# cat_df$label[cat_df$Cutaneous.Leishmaniasis == "moderate"] <- 1
# cat_df$label[cat_df$Cutaneous.Leishmaniasis == "high"] <- 2

cat_df$Year <- as.numeric(cat_df$Year)
cat_df$Population <- as.numeric(cat_df$Population)
cat_df$OptTemp_Obs <- as.numeric(cat_df$OptTemp_Obs)
```



Create Random Forest for Classification:
```{r}
cutaneous.rf <- randomForest(cat_df$Cutaneous.Leishmaniasis ~ .,data = cat_df, importance = TRUE, proximity  = TRUE)
```


Print the Classification Mode:
```{r}
print(cutaneous.rf)
```

Plotting graph between error and number of trees

```{r}
# Output to be present
# As PNG file 
png(file = "randomForestClassification.png")
   
# Plot the error vs 
# The number of trees graph
plot(cutaneous.rf)
   
# Saving the file
dev.off()
```






